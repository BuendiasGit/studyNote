# 第四章 存储系统

## 4.1 基本概念

### 4.1.1 存储体系及分支

因主存速度满足不了要求而引出了cache存储器.Cache存储器不仅对应用程序员是透明的，对系统程序员也是透明的。虚拟存储器对应用程序员透明对系统程序员不透明。

### 4.1.2 存储体系的构成依据

计算机程序具有局部性。

### 4.1.3 存储体系的性能参数

命中率H定义为CPU产生的逻辑地址能在M1中访问到（命中）的概率。

## 4.2 虚拟存储器

### 4.2.1 虚拟存储器的管理方式

依据存储映像算法的不同，主要有段式、页式和段页式。

### 4.2.2 页式虚拟存储器的构成

#### 1.地址的映像和变换

将主存空间和程序空间按照相同大小机械的等分成页。

页式虚拟存储器一般采用让每道程序的任意虚页可以映像装入到任何实页位置的全相联映像。

全相联映像也称为页表法。

另一种方法是把页表压缩成只存放已装入主存的那些虚夜，称为相联目录表法，目录表法。

#### 2.页面置换法

替换算法的确定主要看主存是否有高的命中率，也要看算法是否易于实现，近期最少使用算法。

优化替换算法，在时刻t找出主存中每个页将要用到的时间t选择其中最大的作为替换页。

影响命中率的因素除了算法外，还有地址流、页面大小和主存容量等。

堆栈型替换算法。

## 4.3 高速缓冲存储器

### 4.3.1 工作原理和基本结构

高速缓冲存储器是为弥补主存速度不足。

不仅对应用程序员透明，对系统程序员也透明。

为了加速调块，有cache存储器的主存采用多提交叉存储器。

### 4.3.2 地址的映像和变换

#### 1.全相联映像和变换

#### 2.直接映像及其变换

把主存空间按cache大小等分成区。

#### 3.组相联映像机器变换

减少块冲突率，提高cache空间利用率。

按照区号、组号、组内块号、组内地址分为四个字段。

成本相较全相联低，效率接近全相联。

### 4.3.4 cache存储器的透明性及性能分析

必须采取措施解决好由于读写过程中产生的cache和主存对应内容不一致的问题。

一般有写回法和写直达法。

写直达法中缓冲器用于缓冲有cache所要求的要写回主存的内容。

