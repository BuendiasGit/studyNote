# 第二章 数据表示、寻址方式和指令系统

## 2.1 数据表示

### 2.1.1 数据表示与数据结构

数据表示指的是能由计算机硬件识别和引用的数据类型，表现在它有对这种类型的数据进行操作的指令和运算部件。

### 2.1.2 高级数据表示

#### 1.自定义数据表示

自定义数据表示包括标识符数据表示和数据描述符两类

##### 1）标识符数据标识会带来的问题

1.每个数据字因增设标识符，会增加程序所占的主存空间

2.采用标识符会降低指令的执行速度

##### 2）数据描述符

数据描述符和标识符的差别在于标识符是和每个数据相连的；数据描述符则是于数据分开存放

### 2.1.3 引入数据表示的原则

#### 原则一

看系统的效率是否由显著提高

#### 原则二

看引入这种数据表示后，其通用性和利用率是否提高

### 2.1.4 浮点数尾数基值大小和下溢处理方法的选择

#### 1.浮点数位数基数的选择

#### 2.浮点数位数的下溢处理方法

##### 1.截断法

实现简单，不增加硬件，不需要处理时间，最大误差较大，平均误差大且无法调节

##### 2.舍入法

##### 3.恒置1法

##### 4.查表舍入法

下溢处理表的内容安排成当位数最低k-1位全1的时候，截断法处理，其余情况舍入法

这种精度的损失对系统程序和应用程序的设计者都是透明的。

## 2.2 寻址方式

寻址方式指的是指令按照什么方式寻找到所需的操作数或信息的。

### 2.2.1 寻址方式的三种面向

面向主存、面向寄存器和面向堆栈。

面向主存的寻址主要访问主存，少量访问寄存器。面对寄存器的寻址主要访问寄存器，少量访问主存和对战。面向堆栈的寻址主要访问堆栈，少量访问主存或寄存器。

### 2.2.2 寻址方式在指令中的指明

操作码、寻址方式位

寻址方式位需要专门的字段，因此指令要比操作码的方式长

## 2.3 指令操作码的设计和优化

### 2.3.2 指令操作码的优化

指令是由操作吗和地址吗组成

利用哈夫曼算法构造哈夫曼树，有效减少操作码长度。

#### 哈夫曼编码

将所有指令按照使用频度由小到大排序，每次选择其中最小的两个频度合成一个频度，作为两者之间的新节点，再按照频度大小插入剩下未合并的频度值中。

实际执行的时候注意每次频度最小的以原始数据优先。即：如果三个0.02，两个是原有的，一个是由两个0.01合成的，两个原生的优先合成新的频度

由于哈夫曼编码中的短码不可能是长码的前缀，保证了解码的唯一性和实时性。

### 2.3.3 指令字格式的优化

指令字格式优化的措施包括

1.采用扩展操作码，缩短操作码的平均码长

2.采用基址、变址、相对等多种寻址方式，缩短地址码长度。

3.采用多种地址制，从宏观上缩短程序的长度，加快程序的执行速度。

4.在同种地址制内采用多种地址形式，让每种地址字段都可以由多种长度，且让长操作码与短操作码进行组配。

5.在维持指令字在存储器中安整数边界存储的前地下，使用多种不同的指令字长度

## 2.4 指令系统的发展和改进

### 2.4.1 两种途径和方向(CISC和RISC)

CISC是如何进一步增强原有指令的功能以及设置更为复杂的新指令以取代原先由软件子程序完成的功能，实现软件功能硬化，称为复杂指令系统计算机。

RISC是如何通过减少指令种类和简化指令功能来降低硬件设计的复杂度，提高指令的执行速度，称为精简指令系统计算机。

### 2.4.2 按照CISC方向发展和改进的指令系统

1.面向目标程序的优化实现改进

2.面向高级语言的优化实现改进

3.面向操作系统的优化实现改进

### 2.4.3按照RISC方向发展和改进指令系统

#### 1.CISC的问题

1) 指令系统庞大，许多指令功能复杂

2) 许多指令的操作繁杂，执行速度很低

3) 由于指令系统庞大，使得高级语言编译程序选择目标指令的范围过大。

4) 各种指令的使用频率不会太高，基本符合二八定律。

#### 2.设计RISC的基本原则

1) 只选择使用频度很高的指令

2) 减少指令系统所使用寻址方式的种类，一般不超过两种

3) 让所有的指令都在一个机器周期内完成

4) 扩大通用寄存器数，尽量减少访存

5) 为提高指令执行的速度，大多数指令都是用硬联控制实现。

6) 通过精简指令和优化设计编译程序。

#### 3.设计RISC结构采用的基本技术

在cpu中设置大量工作寄存器并采用重叠寄存器窗口。减少访存

#### 4.RISC技术的发展

1）简化指令系统设计

2）提高计算机的执行速度和效率

3） 降低设计成本，提高系统的可靠性

4） 可直接支持高级语言的实现，简化编译程序的设计

#### RISC的问题和不足

1） 指令少

2） 对浮点运算的执行不足

3） RISC的计算机的编译程序编写难度高