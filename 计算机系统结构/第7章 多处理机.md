# 第七章 多处理机

## 7.1 多处理机的概念、问题和硬件结构

### 7.1.1 多处理机的基本概念和要解决的技术问题

多处理机是属于多指令流多数据流的系统，与单指令流多数据流的阵列处理机的主要差别在于：

并行性的等级不同，阵列处理机主要是针对向量、数组处理，事项向量指令操作级的并行，是开发并行性中的同时性。多处理机实现的则是更高一级的作业或人物间的并行模式开发并行性中的并发性。

### 7.1.2 多处理机的硬件结构

为减少访主存冲突，主存采用模m多体交叉存取。松耦合多处理机可分为非层次型和层次型两种构形。

## 7.3 多处理机的并行性和性能

多处理机并行性既存在于指令内部，也存在于指令外部。

### 7.3.1 并行算法

#### 1. 并行算法的定义和分类

根据各处理机计算任务的大小不同，并行算法分为细粒度、中粒度和粗粒度3种。

#### 2.多处理机并行算法的研究思路

用P表示可并行处理机机数，用T表示P台处理机运算的级数，用多处理机的加速比S表示单处理机顺序运算的级数T1与P太处理机并行运算的级数Tp之比，用E表示P台处理机的设备利用率E=S/P可见，S>=1的时候E<=1，即运算加速总是随着效率的下降。

霍纳法减小树高

### 7.3.2 程序并行性分析

指令之间数据相关可能由先写后读、先读后写和写写三种

#### 1.数据相关

#### 2.数据反相关

#### 3.数据输出相关

#### 结论

两个程序段之间若有先写后读数据相关，不能并行；若有先读后写数据反相关，可以并行执行，但必须保证其写入共享主存时的先读后写次序，不能交换串行；写写的数据输出相关，可以并行执行。

### 7.3.3 并行语言与并行编译

并行过程的特点时这些进程在时间上重叠的执行。

并行任务的派生是使一个任务在执行的同时，派生出可与它并行执行的其他一个或多个任务，分配给不同的处理机完成。

用FORK语句派生并行任务，用JOIN语句对多个并发任务汇合。

FORK语句的形式为FORK m，其中m为新进程开始的标号。

与FORK语句相配合，作为每个并发进程的终端语句JOIN的形式为JOIN n，n为并发进程的个数。JOIN语句附有一个计数器，其初始值为0，每当执行JOIN n语句的时候，计数器值+1，并与n比较。如果相等，表明这是执行中第n个并发进程经过JOIN语句，允许该进程通过JOIN语句，将计数器清零。不相等，则不是最后一个，可以让当前执行JOIN语句的进程先结束，将其占用的处理机释放出来，分配给正在等待的任务，没有任务则处理器空闲。

## 7.4 多处理机的操作系统

三类，主从、各自独立、浮动。

